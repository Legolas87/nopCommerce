@using Nop.Web.Framework.Models.AdminAreaTour
@inject Nop.Services.Stores.IStoreService storeService
@inject Nop.Services.Messages.IEmailAccountService emailAccountService
@inject Nop.Services.Topics.ITopicService topicService

@{
    var showTour = ViewBag.ShowTour ?? false;
}
@if (showTour)
{
    <link rel="stylesheet" href="~/lib_npm/shepherd.js/css/shepherd.css" />
    <script src="~/lib_npm/shepherd.js/js/shepherd.min.js"></script>
    <script src="~/js/admintour/admin.tour.common.js"></script>

    int? entityId = null;
    var tourStep = (TourStep)ViewBag.TourStep;
    switch (tourStep)
    {
        case TourStep.GeneralSettings:
            entityId = (await storeService.GetAllStoresAsync()).FirstOrDefault()?.Id ?? 0;

            <script asp-exclude-from-bundle="true" asp-location="Footer" src="~/js/admintour/admin.tour.generalsettings.js"></script>
            <script asp-location="Footer">
                var localized_data = {
                    PersonalizeStoreIntroTitle: '@await T("Admin.ConfigurationSteps.PersonalizeStore.Intro.Title")',
                    PersonalizeStoreIntroText: '@await T("Admin.ConfigurationSteps.PersonalizeStore.Intro.Text")',

                    PersonalizeStoreBasicAdvancedTitle: '@await T("Admin.ConfigurationSteps.PersonalizeStore.BasicAdvanced.Title")',
                    PersonalizeStoreBasicAdvancedText: '@await T("Admin.ConfigurationSteps.PersonalizeStore.BasicAdvanced.Text")',

                    PersonalizeStoreThemeTitle: '@await T("Admin.ConfigurationSteps.PersonalizeStore.Theme.Title")',
                    PersonalizeStoreThemeText: '@await T("Admin.ConfigurationSteps.PersonalizeStore.Theme.Text", OfficialSite.Themes + Utm.OnAdminTour, Docs.Themes + Utm.OnAdminTourDocs)',

                    PersonalizeStoreLogoTitle: '@await T("Admin.ConfigurationSteps.PersonalizeStore.Logo.Title")',
                    PersonalizeStoreLogoText: '@await T("Admin.ConfigurationSteps.PersonalizeStore.Logo.Text")',
                };
            </script>
            break;

        case TourStep.Store:

            <script asp-exclude-from-bundle="true"  src="~/js/admintour/admin.tour.store.js" asp-location="Footer"></script>
            <script asp-location="Footer">
                var localized_data = {
                    Back: '@await T("Admin.ConfigurationSteps.Back")',
                    NextStep: '@await T("Admin.ConfigurationSteps.NextStep")',
                    NextPage: '@await T("Admin.ConfigurationSteps.NextPage")',

                    StoreNameTitle: '@await T("Admin.ConfigurationSteps.Store.Name.Title")',
                    StoreNameText: '@await T("Admin.ConfigurationSteps.Store.Name.Text")',

                    StoreUrlTitle: '@await T("Admin.ConfigurationSteps.Store.Url.Title")',
                    StoreUrlText: '@await T("Admin.ConfigurationSteps.Store.Url.Text")',

                    StoreSslTitle: '@await T("Admin.ConfigurationSteps.Store.Ssl.Title")',
                    StoreSslText: '@await T("Admin.ConfigurationSteps.Store.Ssl.Text", Docs.SslInstall + Utm.OnAdminTourDocs)',
                };
            </script>
            break;

        case TourStep.ShippingProviders:

            <script asp-exclude-from-bundle="true" src="~/js/admintour/admin.tour.shippingproviders.js" asp-location="Footer"></script>
            <script asp-location="Footer">
                var localized_data = {
                    ShippingProvidersProvidersTitle: '@await T("Admin.ConfigurationSteps.ShippingProviders.Providers.Title")',
                    ShippingProvidersProvidersText: '@await T("Admin.ConfigurationSteps.ShippingProviders.Providers.Text", OfficialSite.ShippingPlugins + Utm.OnAdminTourDocs.Replace('?', '&'))',

                    ShippingProvidersManualTitle: '@await T("Admin.ConfigurationSteps.ShippingProviders.Manual.Title")',
                    ShippingProvidersManualText: '@await T("Admin.ConfigurationSteps.ShippingProviders.Manual.Text")',

                    ShippingProvidersShipStationTitle: '@await T("Admin.ConfigurationSteps.ShippingProviders.ShipStation.Title")',
                    ShippingProvidersShipStationText: '@await T("Admin.ConfigurationSteps.ShippingProviders.ShipStation.Text", Docs.ShipStation + Utm.OnAdminTourDocs)',

                    ShippingProvidersActivateTitle: '@await T("Admin.ConfigurationSteps.ShippingProviders.Activate.Title")',
                    ShippingProvidersActivateText: '@await T("Admin.ConfigurationSteps.ShippingProviders.Activate.Text")',

                    ShippingProvidersConfigureTitle: '@await T("Admin.ConfigurationSteps.ShippingProviders.Configure.Title")',
                    ShippingProvidersConfigureText: '@await T("Admin.ConfigurationSteps.ShippingProviders.Configure.Text")',
                };
            </script>
            break;

        case TourStep.ShippingManual:

            <script asp-exclude-from-bundle="true" src="~/js/admintour/admin.tour.shippingmanual.js" asp-location="Footer"></script>
            <script asp-location="Footer">
                var localized_data = {
                    ConfigureManualSwitchTitle: '@await T("Admin.ConfigurationSteps.ConfigureManual.Switch.Title")',
                    ConfigureManualSwitchText: '@await T("Admin.ConfigurationSteps.ConfigureManual.Switch.Text")',

                    ConfigureManualFixedRateTitle: '@await T("Admin.ConfigurationSteps.ConfigureManual.FixedRate.Title")',
                    ConfigureManualFixedRateText: '@await T("Admin.ConfigurationSteps.ConfigureManual.FixedRate.Text")',

                    ConfigureManualByWeightTitle: '@await T("Admin.ConfigurationSteps.ConfigureManual.ByWeight.Title")',
                    ConfigureManualByWeightText: '@await T("Admin.ConfigurationSteps.ConfigureManual.ByWeight.Text")',

                    ConfigureManualMethodsTitle: '@await T("Admin.ConfigurationSteps.ConfigureManual.Methods.Title")',
                    ConfigureManualMethodsText: '@await T("Admin.ConfigurationSteps.ConfigureManual.Methods.Text")',

                    ConfigureManualEditTitle: '@await T("Admin.ConfigurationSteps.ConfigureManual.Edit.Title")',
                    ConfigureManualEditText: '@await T("Admin.ConfigurationSteps.ConfigureManual.Edit.Text")',

                    ConfigureManualManageTitle: '@await T("Admin.ConfigurationSteps.ConfigureManual.Manage.Title")',
                    ConfigureManualManageText: '@await T("Admin.ConfigurationSteps.ConfigureManual.Manage.Text")',
                };
            </script>
            break;

        case TourStep.PaymentMethods:

            <script asp-exclude-from-bundle="true" src="~/js/admintour/admin.tour.paymentmethods.js" asp-location="Footer"></script>
            <script asp-location="Footer">
                var localized_data = {
                    PaymentMethodsPaymentMethodsTitle: '@await T("Admin.ConfigurationSteps.PaymentMethods.PaymentMethods.Title")',
                    PaymentMethodsPaymentMethodsText: '@await T("Admin.ConfigurationSteps.PaymentMethods.PaymentMethods.Text")',

                    PaymentMethodsCheckMoneyTitle: '@await T("Admin.ConfigurationSteps.PaymentMethods.CheckMoney.Title")',
                    PaymentMethodsCheckMoneyText: '@await T("Admin.ConfigurationSteps.PaymentMethods.CheckMoney.Text")',

                    PaymentMethodsManualTitle: '@await T("Admin.ConfigurationSteps.PaymentMethods.Manual.Title")',
                    PaymentMethodsManualText: '@await T("Admin.ConfigurationSteps.PaymentMethods.Manual.Text")',

                    PaymentMethodsPayPalTitle: '@await T("Admin.ConfigurationSteps.PaymentMethods.PayPal.Title")',
                    PaymentMethodsPayPalText: '@await T("Admin.ConfigurationSteps.PaymentMethods.PayPal.Text", Docs.PayPal + Utm.OnAdminTourDocs)',

                    PaymentMethodsActivateTitle: '@await T("Admin.ConfigurationSteps.PaymentMethods.Activate.Title")',
                    PaymentMethodsActivateText: '@await T("Admin.ConfigurationSteps.PaymentMethods.Activate.Text")',


                    PaymentMethodsConfigureTitle: '@await T("Admin.ConfigurationSteps.PaymentMethods.Configure.Title")',
                    PaymentMethodsConfigureText: '@await T("Admin.ConfigurationSteps.PaymentMethods.Configure.Text")',
                };
            </script>
            break;

        case TourStep.TaxProviders:

            <script asp-exclude-from-bundle="true" src="~/js/admintour/admin.tour.taxproviders.js" asp-location="Footer"></script>
            <script asp-location="Footer">
                var localized_data = {
                    TaxProvidersTaxProvidersTitle: '@await T("Admin.ConfigurationSteps.TaxProviders.TaxProviders.Title")',
                    TaxProvidersTaxProvidersText: '@await T("Admin.ConfigurationSteps.TaxProviders.TaxProviders.Text", OfficialSite.TaxPlugins + Utm.OnAdminTourDocs.Replace('?', '&'))',

                    TaxProvidersAvalaraTitle: '@await T("Admin.ConfigurationSteps.TaxProviders.Avalara.Title")',
                    TaxProvidersAvalaraText: '@await T("Admin.ConfigurationSteps.TaxProviders.Avalara.Text", Docs.Avalara + Utm.OnAdminTourDocs)',

                    TaxProvidersManualTitle: '@await T("Admin.ConfigurationSteps.TaxProviders.Manual.Title")',
                    TaxProvidersManualText: '@await T("Admin.ConfigurationSteps.TaxProviders.Manual.Text")',

                    TaxProvidersPrimaryProviderTitle: '@await T("Admin.ConfigurationSteps.TaxProviders.PrimaryProvider.Title")',
                    TaxProvidersPrimaryProviderText: '@await T("Admin.ConfigurationSteps.TaxProviders.PrimaryProvider.Text")',

                    TaxProvidersConfigureTitle: '@await T("Admin.ConfigurationSteps.TaxProviders.Configure.Title")',
                    TaxProvidersConfigureText: '@await T("Admin.ConfigurationSteps.TaxProviders.Configure.Text")',
                };
            </script>
            break;

        case TourStep.TaxManual:

            <script asp-exclude-from-bundle="true" src="~/js/admintour/admin.tour.taxmanual.js" asp-location="Footer"></script>
            <script asp-location="Footer">
                var localized_data = {
                    TaxManualSwitchTitle: '@await T("Admin.ConfigurationSteps.TaxManual.Switch.Title")',
                    TaxManualSwitchText: '@await T("Admin.ConfigurationSteps.TaxManual.Switch.Text")',

                    TaxManualFixedTitle: '@await T("Admin.ConfigurationSteps.TaxManual.Fixed.Title")',
                    TaxManualFixedText: '@await T("Admin.ConfigurationSteps.TaxManual.Fixed.Text")',

                    TaxManualByCountryTitle: '@await T("Admin.ConfigurationSteps.TaxManual.ByCountry.Title")',
                    TaxManualByCountryText: '@await T("Admin.ConfigurationSteps.TaxManual.ByCountry.Text")',

                    TaxManualCategoriesTitle: '@await T("Admin.ConfigurationSteps.TaxManual.Categories.Title")',
                    TaxManualCategoriesText: '@await T("Admin.ConfigurationSteps.TaxManual.Categories.Text")',

                    TaxManualEditTitle: '@await T("Admin.ConfigurationSteps.TaxManual.Edit.Title")',
                    TaxManualEditText: '@await T("Admin.ConfigurationSteps.TaxManual.Edit.Text")',
                };
            </script>
            break;

        case TourStep.Product:

            <script asp-exclude-from-bundle="true" src="~/js/admintour/admin.tour.product.js" asp-location="Footer"></script>
            <script asp-location="Footer">
                var localized_data = {
                    ProductSettingsButtonTitle: '@await T("Admin.ConfigurationSteps.Product.SettingsButton.Title")',
                    ProductSettingsButtonText: '@await T("Admin.ConfigurationSteps.Product.SettingsButton.Text")',

                    ProductDetailsTitle: '@await T("Admin.ConfigurationSteps.Product.Details.Title")',
                    ProductDetailsText: '@await T("Admin.ConfigurationSteps.Product.Details.Text")',

                    ProductPriceTitle: '@await T("Admin.ConfigurationSteps.Product.Price.Title")',
                    ProductPriceText: '@await T("Admin.ConfigurationSteps.Product.Price.Text", Docs.Currencies + Utm.OnAdminTourDocs)',

                    ProductTaxTitle: '@await T("Admin.ConfigurationSteps.Product.Tax.Title")',
                    ProductTaxText: '@await T("Admin.ConfigurationSteps.Product.Tax.Text")',

                    ProductShippingTitle: '@await T("Admin.ConfigurationSteps.Product.Shipping.Title")',
                    ProductShippingText: '@await T("Admin.ConfigurationSteps.Product.Shipping.Text")',

                    ProductInventoryTitle: '@await T("Admin.ConfigurationSteps.Product.Inventory.Title")',
                    ProductInventoryText: '@await T("Admin.ConfigurationSteps.Product.Inventory.Text")',

                    ProductPicturesTitle: '@await T("Admin.ConfigurationSteps.Product.Pictures.Title")',
                    ProductPicturesText: '@await T("Admin.ConfigurationSteps.Product.Pictures.Text")',
                };
            </script>
            break;

        case TourStep.EmailAccountList:
            entityId = (await emailAccountService.GetAllEmailAccountsAsync()).FirstOrDefault()?.Id ?? 0;

            <script asp-exclude-from-bundle="true" src="~/js/admintour/admin.tour.emailaccountlist.js" asp-location="Footer"></script>
            <script asp-location="Footer">
                var localized_data = {
                    EmailAccountListEmailAccounts1Title: '@await T("Admin.ConfigurationSteps.EmailAccountList.EmailAccounts1.Title")',
                    EmailAccountListEmailAccounts1Text: '@await T("Admin.ConfigurationSteps.EmailAccountList.EmailAccounts1.Text")',

                    EmailAccountListEmailAccounts2Title: '@await T("Admin.ConfigurationSteps.EmailAccountList.EmailAccounts2.Title")',
                    EmailAccountListEmailAccounts2Text: '@await T("Admin.ConfigurationSteps.EmailAccountList.EmailAccounts2.Text")',

                    EmailAccountListDefaultEmailAccountTitle: '@await T("Admin.ConfigurationSteps.EmailAccountList.DefaultEmailAccount.Title")',
                    EmailAccountListDefaultEmailAccountText: '@await T("Admin.ConfigurationSteps.EmailAccountList.DefaultEmailAccount.Text")',

                    EmailAccountListEditTitle: '@await T("Admin.ConfigurationSteps.EmailAccountList.Edit.Title")',
                    EmailAccountListEditText: '@await T("Admin.ConfigurationSteps.EmailAccountList.Edit.Text")',
                };
            </script>
            break;

        case TourStep.EmailAccount:

            <script asp-exclude-from-bundle="true" src="~/js/admintour/admin.tour.emailaccount.js" asp-location="Footer"></script>
            <script asp-location="Footer">
                var localized_data = {
                    EmailAccountEmailAddressTitle: '@await T("Admin.ConfigurationSteps.EmailAccount.EmailAddress.Title")',
                    EmailAccountEmailAddressText: '@await T("Admin.ConfigurationSteps.EmailAccount.EmailAddress.Text")',

                    EmailAccountDisplayNameTitle: '@await T("Admin.ConfigurationSteps.EmailAccount.DisplayName.Title")',
                    EmailAccountDisplayNameText: '@await T("Admin.ConfigurationSteps.EmailAccount.DisplayName.Text")',

                    EmailAccountHostTitle: '@await T("Admin.ConfigurationSteps.EmailAccount.Host.Title")',
                    EmailAccountHostText: '@await T("Admin.ConfigurationSteps.EmailAccount.Host.Text")',

                    EmailAccountPortTitle: '@await T("Admin.ConfigurationSteps.EmailAccount.Port.Title")',
                    EmailAccountPortText: '@await T("Admin.ConfigurationSteps.EmailAccount.Port.Text")',

                    EmailAccountUsernameTitle: '@await T("Admin.ConfigurationSteps.EmailAccount.Username.Title")',
                    EmailAccountUsernameText: '@await T("Admin.ConfigurationSteps.EmailAccount.Username.Text")',

                    EmailAccountPasswordTitle: '@await T("Admin.ConfigurationSteps.EmailAccount.Password.Title")',
                    EmailAccountPasswordText: '@await T("Admin.ConfigurationSteps.EmailAccount.Password.Text")',

                    EmailAccountUseSslTitle: '@await T("Admin.ConfigurationSteps.EmailAccount.UseSsl.Title")',
                    EmailAccountUseSslText: '@await T("Admin.ConfigurationSteps.EmailAccount.UseSsl.Text")',

                    EmailAccountDefaultCredentialsTitle: '@await T("Admin.ConfigurationSteps.EmailAccount.DefaultCredentials.Title")',
                    EmailAccountDefaultCredentialsText: '@await T("Admin.ConfigurationSteps.EmailAccount.DefaultCredentials.Text")',

                    EmailAccountTestEmailTitle: '@await T("Admin.ConfigurationSteps.EmailAccount.TestEmail.Title")',
                    EmailAccountTestEmailText: '@await T("Admin.ConfigurationSteps.EmailAccount.TestEmail.Text")',
                };
            </script>
            break;

        case TourStep.TopicList:
            entityId = (await topicService.GetTopicBySystemNameAsync("ShippingInfo"))?.Id ?? 0;

            <script asp-exclude-from-bundle="true" src="~/js/admintour/admin.tour.topiclist.js" asp-location="Footer"></script>
            <script asp-location="Footer">
                var localized_data = {
                    Done: '@await T("Admin.ConfigurationSteps.Done")',

                    TopicListTopics1Title: '@await T("Admin.ConfigurationSteps.TopicList.Topics1.Title")',
                    TopicListTopics1Text: '@await T("Admin.ConfigurationSteps.TopicList.Topics1.Text")',

                    TopicListTopics2Title: '@await T("Admin.ConfigurationSteps.TopicList.Topics2.Title")',
                    TopicListTopics2Text: '@await T("Admin.ConfigurationSteps.TopicList.Topics2.Text")',

                    TopicListShippingTitle: '@await T("Admin.ConfigurationSteps.TopicList.Shipping.Title")',
                    TopicListShippingText: '@await T("Admin.ConfigurationSteps.TopicList.Shipping.Text")',

                    TopicListLocationTitle: '@await T("Admin.ConfigurationSteps.TopicList.Location.Title")',
                    TopicListLocationText: '@await T("Admin.ConfigurationSteps.TopicList.Location.Text")',

                    TopicListEditTitle: '@await T("Admin.ConfigurationSteps.TopicList.Edit.Title")',
                    TopicListEditText: '@await T("Admin.ConfigurationSteps.TopicList.Edit.Text")',
                };
            </script>
            break;

        case TourStep.Topic:

            <script asp-exclude-from-bundle="true" src="~/js/admintour/admin.tour.topic.js" asp-location="Footer"></script>
            <script asp-location="Footer">
                var localized_data = {
                    Done: '@await T("Admin.ConfigurationSteps.Done")',

                    TopicTitleContentTitle: '@await T("Admin.ConfigurationSteps.Topic.TitleContent.Title")',
                    TopicTitleContentText: '@await T("Admin.ConfigurationSteps.Topic.TitleContent.Text")',

                    TopicPreviewTitle: '@await T("Admin.ConfigurationSteps.Topic.Preview.Title")',
                    TopicPreviewText: '@await T("Admin.ConfigurationSteps.Topic.Preview.Text")',
                };
            </script>
            break;

        default:
            break;
    }

    <script asp-location="Footer">
        localized_data.Back = '@await T("Admin.ConfigurationSteps.Back")';
        localized_data.NextStep = '@await T("Admin.ConfigurationSteps.NextStep")';
        localized_data.NextPage = '@await T("Admin.ConfigurationSteps.NextPage")';

        AdminTourDataProvider.init(localized_data, @entityId);
    </script>
}

